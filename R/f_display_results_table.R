# WARNING - Generated by {fusen} from /dev/severity_index.Rmd: do not edit by hand

#' Display results table
#' 
#' Outputs an interactive results table suitable for HTML documents and the app.
#' Can be further formatted (e.g. conditional formatting) to preference in the 
#' app stage. This is just a demo.
#' 
#' @param coin The coin.
#' @param type set One of `"scores"` or `"ranks"`.
#' 
#' @importFrom rlang abort
#' @return An interactive table using DT.
#' 
#' @export
#' @examples
#' MVI <- f_data_input(file_path = system.file("data_input/data_module-input.xlsx",
#'                                             package = "BuildIndex") )
#' 
#' MVI <- f_build_index(MVI)
#' f_display_results_table(MVI)
f_display_results_table <- function(coin, type = "scores"){

  if(type == "scores"){
    df_results <- coin$Results$FullScore
  } else if (type == "ranks"){
    df_results <- coin$Results$FullRank
  }

  if(is.null(df_results)){
    rlang::abort("Can't find results in the coin. Did you forget to build the index first?")
  }

  df_results |>
    DT::datatable() |>
    DT::formatStyle(columns = ncol(df_results),
                fontSize = '50%')
    
}
