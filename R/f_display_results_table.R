# WARNING - Generated by {fusen} from /dev/severity_index.Rmd: do not edit by hand

#' Display results table
#' 
#' Outputs an interactive results table suitable for HTML documents and the app.
#' .
#' @param coin COIN object, or list with first entry is the indicator metadata, 
#'              second entry is the aggregation metadata
#' 
#' @param type set type = "scores" or "ranks"
#' @importFrom rlang abort
#' @return a visualised data table
#' 
#' @export
#' @examples
#' MVI <- f_data_input(file_path = system.file("data_input/data_module-input.xlsx",
#'                                             package = "BuildIndex") )
#' 
#' ## when using create a data-raw folder and put you data input xlsx file there
#' # MVI <- f_data_input(here::here("data-raw", "data_module-input.xlsx"))
#' 
#' MVI2 <- f_build_index(coin = MVI)
#' f_display_results_table(coin = MVI2)
f_display_results_table <- function(coin, type = "scores"){

  if(type == "scores"){
    df_results <- coin$Results$FullScore
  } else if (type == "ranks"){
    df_results <- coin$Results$FullRank
  }

  if(is.null(df_results)){
    rlang::abort("Can't find results in the coin. Did you forget to build the index first?")
  }

  df_results |>
    DT::datatable() |>
    DT::formatStyle(columns = ncol(df_results),
                fontSize = '50%')
    
}
