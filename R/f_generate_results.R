# WARNING - Generated by {fusen} from /dev/severity_index.Rmd: do not edit by hand

#' Generate results
#' 
#' Generates sorted results tables and attaches back to the coin
#' 
#' @param coin COIN object, or list with first entry is the indicator metadata, 
#'              second entry is the aggregation metadata
#'              
#' @importFrom COINr is.coin get_results
#' @return coin COIN object
#' 
#' @export
#' @examples
#' MVI <- f_data_input(file_path = system.file("data_input/data_module-input.xlsx",
#'                                             package = "BuildIndex") )
#' 
#' ## when using create a data-raw folder and put you data input xlsx file there
#' # MVI <- f_data_input(here::here("data-raw", "data_module-input.xlsx"))
#' 
#' MVI2 <- f_build_index(coin = MVI)
#' 
#' f_generate_results(coin = MVI2)
f_generate_results <- function(coin){

  stopifnot(COINr::is.coin(coin),
            !is.null(coin$Data$Aggregated))

  # generate results tables (attached to coin, so will appear when exported to Excel)
  coin <- COINr::get_results(coin, dset = "Aggregated", tab_type = "Full",
                      also_get = "uName", nround = 1, out2 = "coin")
  coin <- COINr::get_results(coin, dset = "Aggregated", tab_type = "Full", use = "ranks",
                      also_get = "uName", nround = 1, out2 = "coin")

  return(coin)
    
}
